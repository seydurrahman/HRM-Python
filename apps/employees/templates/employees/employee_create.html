{% extends 'base.html' %} 
{% load static %} 
{% load widget_tweaks %}

{% block title %}Create Employee{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm border-0">
    <div class="card-header bg-light border-bottom">
      <h4 class="card-title mb-0">
        <i class="fas fa-user-plus"></i> Create New Employee
      </h4>
    </div>

    <div class="card-body">
      <form method="POST" enctype="multipart/form-data" id="employeeForm">
        {% csrf_token %}

        <!-- ========================== NAV TABS ========================== -->
        <ul class="nav nav-pills mb-4" id="employeeTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="employee-tab"
              data-bs-toggle="pill"
              data-bs-target="#employee"
              type="button"
              role="tab"
            >
              <i class="fas fa-id-card"></i> Employee Info
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="basic-tab"
              data-bs-toggle="pill"
              data-bs-target="#basic"
              type="button"
              role="tab"
            >
              <i class="fas fa-info-circle"></i> Basic Info
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="offical_info-tab"
              data-bs-toggle="pill"
              data-bs-target="#official_info"
              type="button"
              role="tab"
            >
              <i class="fas fa-address-book"></i> Official Info
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="job_experience-tab"
              data-bs-toggle="pill"
              data-bs-target="#job_experience"
              type="button"
              role="tab"
            >
              <i class="fas fa-briefcase"></i> Job Experience
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="salary_info-tab"
              data-bs-toggle="pill"
              data-bs-target="#salary_info"
              type="button"
              role="tab"
            >
              <i class="fas fa-sack-dollar"></i> Salary Info
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="education-tab"
              data-bs-toggle="pill"
              data-bs-target="#education"
              type="button"
              role="tab"
            >
              <i class="fas fa-graduation-cap"></i> Educations
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="leave-tab"
              data-bs-toggle="pill"
              data-bs-target="#leave"
              type="button"
              role="tab"
            >
              <i class="fas fa-calendar-check"></i> Leave Info
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="training-tab"
              data-bs-toggle="pill"
              data-bs-target="#training"
              type="button"
              role="tab"
            >
              <i class="fas fa-certificate"></i> Training & Certification
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="document-tab"
              data-bs-toggle="pill"
              data-bs-target="#document"
              type="button"
              role="tab"
            >
              <i class="fas fa-file-archive"></i> Documents
            </button>
          </li>
        </ul>

        <!-- ========================== TAB CONTENT ========================== -->
        <div class="tab-content" id="employeeTabContent">

          <!-- ========== EMPLOYEE INFO TAB ========== -->
          <div class="tab-pane fade show active" id="employee" role="tabpanel">
            <div class="section-title mb-3"><h5>Employee Information</h5></div>
            <div class="row">
              <div class="col-md-4 mb-3">
                {{ form.full_name_English.label_tag }} {{ form.full_name_English}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.full_name_Bangla.label_tag }} {{ form.full_name_Bangla}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.employee_id.label_tag }} {{ form.employee_id }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.designation.label_tag }} {{ form.designation }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.unit.label_tag }}
                {{ form.unit }}
              </div>

              <!-- Division -->
              <div class="col-md-4 mb-3">
                {{ form.division.label_tag }}
                {{ form.division }}
              </div>

              <!-- Department -->
              <div class="col-md-4 mb-3">
                {{ form.department.label_tag }}
                {{ form.department }}
              </div>

              <!-- Section -->
              <div class="col-md-4 mb-3">
                {{ form.section.label_tag }}
                {{ form.section }}
              </div>

              <!-- SubSection -->
              <div class="col-md-4 mb-3">
                {{ form.sub_section.label_tag }}
                {{ form.sub_section }}
              </div>

              <!-- Floor -->
              <div class="col-md-4 mb-3">
                {{ form.floor.label_tag }}
                {{ form.floor }}
              </div>

              <!-- Line -->
              <div class="col-md-4 mb-3">
                {{ form.line.label_tag }}
                {{ form.line }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.mobile_number.label_tag }} {{ form.mobile_number }}
              </div>
              <div class="col-md-3 mb-3">
                {{ form.photo.label_tag }} {{ form.photo }}
              </div>
              
              <div class="col-md-4 mb-3">
                {{ form.email.label_tag }} {{ form.email }}
              </div>
            
            </div>
          </div>

          <!-- ========== BASIC INFO TAB ========== -->
          <div class="tab-pane fade" id="basic" role="tabpanel">
            <div class="section-title mb-3"><h5>Basic Information</h5></div>
            <div class="row">
              <div class="col-md-4 mb-3">
                {{ form.date_of_birth.label_tag }} {{ form.date_of_birth }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.father_name.label_tag }} {{ form.father_name }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.father_name_Bangla.label_tag }} {{form.father_name_Bangla }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.mother_name.label_tag }} {{ form.mother_name }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.mother_name_Bangla.label_tag }} {{form.mother_name_Bangla }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.religion.label_tag }} {{ form.religion }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nationality.label_tag }} {{ form.nationality }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nid_number.label_tag }} {{ form.nid_number }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nid_image.label_tag }} {{ form.nid_image }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.birth_Reg.label_tag }} {{ form.birth_Reg }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.birth_Reg_image.label_tag }} {{ form.birth_Reg_image }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.passport_number.label_tag }} {{ form.passport_number }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.passport_image.label_tag }} {{ form.passport_image }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.personal_email.label_tag }} {{ form.personal_email }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.gender.label_tag }} {{ form.gender }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.marital_status.label_tag }} {{ form.marital_status }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.blood_grp.label_tag }} {{ form.blood_grp }}
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Nominee Information
                </h5>
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_name.label_tag }} {{ form.nominee_name }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_name_Bangla.label_tag }} {{form.nominee_name_Bangla }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_relation.label_tag }} {{ form.nominee_relation}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_nid.label_tag }} {{ form.nominee_nid }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_nid_image.label_tag }} {{ form.nominee_nid_image}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_photo.label_tag }} {{ form.nominee_photo }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_mobile.label_tag }} {{ form.nominee_mobile }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_country.label_tag }} {{ form.nominee_country }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_division.label_tag }} {{ form.nominee_division}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_district.label_tag }} {{ form.nominee_district}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_thana.label_tag }} {{ form.nominee_thana }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_post_office.label_tag }} {{form.nominee_post_office }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_postal_code.label_tag }} {{form.nominee_postal_code }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_village.label_tag }} {{ form.nominee_village }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.nominee_address_line.label_tag }} {{form.nominee_address_line }}
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Emegency Contact
                </h5>
              </div>
              <div class="col-md-4 mb-3">
                {{ form.emergency_contact_name.label_tag }} {{form.emergency_contact_name }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.emergency_contact_number.label_tag }} {{form.emergency_contact_number }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.emergency_contact_relation.label_tag }} {{form.emergency_contact_relation }}
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Present Address
                </h5>
              </div>
              <div class="col-md-4 mb-3">
                {{ form.country.label_tag }} {{ form.country }}
              </div>
              <div class="col-md-4 mb-3" id="perm-division">
                <label for="id_perm_division">Division</label>
                <input type="text" name="perm_division" id="id_perm_division" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-district">
                <label for="id_perm_district">District</label>
                <input type="text" name="perm_district" id="id_perm_district" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-thana">
                <label for="id_perm_thana">Thana</label>
                <input type="text" name="perm_thana" id="id_perm_thana" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-post-office">
                <label for="id_perm_post_office">Post Office</label>
                <input type="text" name="perm_post_office" id="id_perm_post_office" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-post-office-bangla">
                <label for="id_perm_post_office_bangla">Post Office (Bangla)</label>
                <input type="text" name="perm_post_office_bangla" id="id_perm_post_office_bangla" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-postal-code">
                <label for="id_perm_postal_code">Postal Code</label>
                <input type="text" name="perm_postal_code" id="id_perm_postal_code" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-village">
                <label for="id_perm_village">Village</label>
                <input type="text" name="perm_village" id="id_perm_village" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-address-line">
                <label for="id_perm_address_line">Address Line</label>
                <input type="text" name="perm_address_line" id="id_perm_address_line" class="form-control">
              </div>
              <div class="col-md-4 mb-3" id="perm-address-line-bangla">
                <label for="id_perm_address_line_bangla">Address Line (Bangla)</label>
                <input type="text" name="perm_address_line_bangla" id="id_perm_address_line_bangla" class="form-control">
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Permanent Address
                </h5>
                <div class="form-check d-inline-block ms-3">
                  <input class="form-check-input" type="checkbox" id="sameAsPresent">
                  <label class="form-check-label" for="sameAsPresent">
                    Same as Present Address
                  </label>
                </div>
              </div>
              <div class="col-md-4 mb-3" id="perm-country">
                <label for="id_perm_country">Country</label>
                <input type="text" name="perm_country" id="id_perm_country" class="form-control">
              </div>
              <div class="col-md-4 mb-3">
                {{ form.division.label_tag }} {{ form.division }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.district.label_tag }} {{ form.district }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.thana.label_tag }} {{ form.thana }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.post_office.label_tag }} {{ form.post_office }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.post_office_Bangla.label_tag }} {{form.post_office_Bangla }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.postal_code.label_tag }} {{ form.postal_code }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.village.label_tag }} {{ form.village }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.address_line.label_tag }} {{ form.address_line }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.address_line_Bangla.label_tag }} {{form.address_line_Bangla }}
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Local Authority
                </h5>
              </div>
              <div class="col-md-4 mb-3">
                {{ form.local_guardian_name.label_tag }} {{form.local_guardian_name }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.local_guardian_number.label_tag }} {{form.local_guardian_number }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.local_guardian_relation.label_tag }} {{form.local_guardian_relation }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.local_guardian_address.label_tag }} {{form.local_guardian_address }}
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Health & Appearance
                </h5>
              </div>
              <div class="col-md-4 mb-3">
                {{ form.Indentity_sign.label_tag }} {{ form.Indentity_sign }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.weight.label_tag }} {{ form.weight }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.height.label_tag }} {{ form.height }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.blood_group.label_tag }} {{ form.blood_group }}
              </div>
            </div>
          </div>

          <!-- ========== OFFICIAL INFO TAB ========== -->
          <div class="tab-pane fade" id="official_info" role="tabpanel">
            <div class="section-title mb-3"><h5>Official Information</h5></div>
            <div class="row">
              <div class="col-md-4 mb-3">
                {{ form.device_id.label_tag }} {{ form.device_id }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.employee_type.label_tag }} {{ form.employee_type }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.employment_type.label_tag }} {{ form.employment_type }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.employee_category.label_tag }} {{ form.employee_category}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.group.label_tag }} {{ form.group }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.grade.label_tag }} {{ form.grade }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.date_of_joining.label_tag }} {{ form.date_of_joining }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.date_of_confirmation.label_tag }} {{form.date_of_confirmation }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.reporting_manager.label_tag }} {{ form.reporting_manager}}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.work_shift.label_tag }} {{ form.work_shift }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.weekend.label_tag }} {{ form.weekend }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.disburse_type.label_tag }} {{ form.disburse_type }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.mfs_number.label_tag }} {{ form.mfs_number }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.mobile_number.label_tag }} {{ form.mobile_number }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.email.label_tag }} {{ form.email }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.work_location.label_tag }} {{ form.work_location }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.bgmea_id.label_tag }} {{ form.bgmea_id }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.bkmea_id.label_tag }} {{ form.bkmea_id }}
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Bank Information
                </h5>
              </div>
              <div class="col-md-4 mb-3">
                {{ form.bank_name.label_tag }} {{ form.bank_name }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.bank_account_number.label_tag }} {{form.bank_account_number }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.bank_branch.label_tag }} {{ form.bank_branch }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.amount_in_bank.label_tag }} {{ form.amount_in_bank }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.tin_number.label_tag }} {{ form.tin_number }}
              </div>
              <div
                class="d-flex justify-content-center align-items-center col-md-4 mb-3"
              >
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.software_user|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.software_user.id_for_label }}"
                  >
                    Software User
                  </label>
                </div>
                <div class="form-check d-flex align-items-center">
                  {{ form.panel_user|add_class:"form-check-input mt-0 me-2" }}
                  <label
                    class="form-check-label"
                    for="{{ form.panel_user.id_for_label }}"
                  >
                    Panel User
                  </label>
                </div>
              </div>
              <div class="col-md-4 mb-3">
                <div class="mb-2">{{ form.transport.label_tag }}</div>
                <div
                  class="d-flex justify-content-start align-items-center gap-3"
                >
                  <div class="form-check d-flex align-items-center">
                    {{ form.transport|add_class:"form-check-input mt-0 me-2"}}
                    <label
                      class="form-check-label"
                      for="{{ form.transport.id_for_label }}"
                      >Yes</label
                    >
                  </div>
                  <div class="form-check d-flex align-items-center">
                    {{ form.transport|add_class:"form-check-input mt-0 me-2" }}
                    <label
                      class="form-check-label"
                      for="{{ form.transport.id_for_label }}"
                      >No</label
                    >
                  </div>
                </div>
              </div>
              <div class="col-md-4 mb-3">
                <div class="mb-2">{{ form.food_allowance.label_tag }}</div>
                <div
                  class="d-flex justify-content-start align-items-center gap-3"
                >
                  <div class="form-check d-flex align-items-center">
                    {{ form.food_allowance|add_class:"form-check-input mt-0 me-2"}}
                    <label
                      class="form-check-label"
                      for="{{ form.food_allowance.id_for_label }}"
                      >Yes</label
                    >
                  </div>
                  <div class="form-check d-flex align-items-center">
                    {{ form.food_allowance|add_class:"form-check-input mt-0 me-2" }}
                    <label
                      class="form-check-label"
                      for="{{ form.food_allowance.id_for_label }}"
                      >No</label
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ========== JOB EXPERIENCE TAB ========== -->
          <div class="tab-pane fade" id="job_experience" role="tabpanel">
            <div class="section-title mb-3"><h5>Job Experience</h5></div>
            <div id="experience-container">
              <div class="row experience-row align-items-end">
                <div class="col-md-4 mb-3">{{ form.company_name.label_tag }} {{ form.company_name }}</div>
                <div class="col-md-4 mb-3">{{ form.department.label_tag }} {{ form.department }}</div>
                <div class="col-md-4 mb-3">{{ form.designation.label_tag }} {{ form.designation }}</div>
                <div class="col-md-4 mb-3">{{ form.start_date.label_tag }} {{ form.start_date }}</div>
                <div class="col-md-4 mb-3">{{ form.end_date.label_tag }} {{ form.end_date }}</div>
                <div class="col-md-4 mb-3">{{ form.reason_for_leaving.label_tag }} {{ form.reason_for_leaving }}</div>
                <div class="col-md-4 mb-3">{{ form.experienced.label_tag }} {{ form.experienced }}</div>
                <div class="col-md-4 mb-3">{{ form.experienced_certificate.label_tag }} {{ form.experienced_certificate }}</div>
                <div class="col-md-4 mb-3">{{ form.remarks.label_tag }} {{ form.remarks }}</div>
              </div>
            </div>

            <div class="mb-3">
              <button type="button" id="add-experience" class="btn btn-success">+</button>
            </div>
          </div>

          <!-- ========== Salary Info TAB ========== -->
          <div class="tab-pane fade" id="salary_info" role="tabpanel">
            <div class="section-title mb-3"><h5>Salary Policy</h5></div>
            <div class="row">
              <div class="col-md-4 mb-3">
                <label for="{{ form.date_of_joining.id_for_label }}">Effective Date(JD)</label>{{ form.date_of_joining }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.salary_policy.label_tag }} {{form.salary_policy }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.gross_salary.label_tag }} {{ form.gross_salary }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.basic_salary.label_tag }} {{ form.basic_salary }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.house_rent.label_tag }} {{ form.house_rent }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.transport_allowance.label_tag }} {{ form.transport_allowance }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.mobile_bill.label_tag }} {{ form.mobile_bill }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.food_allowance.label_tag }} {{ form.food_allowance }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.medical_allowance.label_tag }} {{ form.medical_allowance }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.other_conveyence.label_tag }} {{ form.other_conveyence }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.attendance_bonus.label_tag }} {{ form.attendance_bonus }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.tax_deduction.label_tag }} {{ form.tax_deduction }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.insurance.label_tag }} {{ form.insurance }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.stamp.label_tag }} {{ form.stamp }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.salary_mode.label_tag }} {{ form.salary_mode }}
              </div>
              <div class="col-md-4 mb-3">
                {{ form.tin_number.label_tag }} {{ form.tin_number }}
              </div>
              <div
                class="d-flex justify-content-center align-items-center col-md-4 mb-3"
              >
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.pF_applicable|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.pF_applicable.id_for_label }}"
                  >
                    PF Applicable
                  </label>
                </div>
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.late_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.late_deduct.id_for_label }}"
                  >
                    Late Deduct
                  </label>
                </div>
              </div>
              <div
                class="d-flex justify-content-center align-items-center col-md-4 mb-3"
              >
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Transport Deduct
                  </label>
                </div>
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.food_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.food_deduct.id_for_label }}"
                  >
                    Food Deduct
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- ========== Educations info TAB ========== -->
          <div class="tab-pane fade" id="education" role="tabpanel">
            <div class="section-title mb-3"><h5>Educations</h5></div>

            <div id="educations-container">
              <!-- first row (template row) -->
              <div class="row educations-row align-items-end">
                <div class="col-md-4 mb-3">{{ form.degree_Name.label_tag }} {{ form.degree_Name }}</div>
                <div class="col-md-4 mb-3">{{ form.institue.label_tag }} {{ form.institue }}</div>
                <div class="col-md-4 mb-3">{{ form.board.label_tag }} {{ form.board }}</div>
                <div class="col-md-4 mb-3">{{ form.subject.label_tag }} {{ form.subject }}</div>
                <div class="col-md-4 mb-3">{{ form.passing_year.label_tag }} {{ form.passing_year }}</div>
                <div class="col-md-4 mb-3">{{ form.result.label_tag }} {{ form.result }}</div>
                <div class="col-md-4 mb-3">{{ form.certificate.label_tag }} {{ form.certificate }}</div>
              </div>
            </div>
            <div class="mb-3">
              <button type="button" id="add-education" class="btn btn-success">+</button>
            </div>
          </div>

          <!-- ========== Leave Info ============ -->
          <div class="tab-pane fade" id="leave" role="tabpanel">
            <div class="section-title mb-3"><h5>Leave Info</h5></div>
            <div class="row">
              <div class="col-md-4 mb-3">
                <label for="{{ form.date_of_joining.id_for_label }}">Effective Date(JD)</label>{{ form.date_of_joining }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Sick Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Casual Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Earn Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Maternity Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Parental Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Annual Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Specail Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Compensatory Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>

              <div class="col-md-4 mb-3">
                <div class="form-check me-3 d-flex align-items-center">
                  {{ form.transport_deduct|add_class:"form-check-input mt-0 me-2"}}
                  <label
                    class="form-check-label"
                    for="{{ form.transport_deduct.id_for_label }}"
                  >
                    Unpaid Leave
                  </label>
                </div>
                {{form.salary_policy }}
              </div>
            </div>
          </div>

          <!-- ========== Training & certificate ======= -->
          <div class="tab-pane fade" id="training" role="tabpanel">
            <div class="section-title mb-3"><h5>Training & Certificate</h5></div>

            <div id="training-container">
              <div class="row training-row align-items-end">
                <div class="col-md-4 mb-3">{{ form.training_name.label_tag }} {{ form.training_name }}</div>
                <div class="col-md-4 mb-3">{{ form.institue_name.label_tag }} {{ form.institue_name }}</div>
                <div class="col-md-4 mb-3">{{ form.duration_Month.label_tag }} {{ form.duration_Month }}</div>
                <div class="col-md-4 mb-3">{{ form.score.label_tag }} {{ form.score }}</div>
                <div class="col-md-4 mb-3">{{ form.remarks.label_tag }} {{ form.remarks }}</div>
                <div class="col-md-4 mb-3">{{ form.certificate.label_tag }} {{ form.certificate }}</div>
              </div>
            </div>

            <div class="mb-3">
              <button type="button" id="add-training" class="btn btn-success">+</button>
            </div>
          </div>

          <!-- ========== Documents TAB ========== -->
          <div class="tab-pane fade" id="document" role="tabpanel">
            <div class="section-title mb-3">
              <h5>Documents</h5>
            </div>
            <div class="col-full mb-3">
              <h5
                class="d-inline"
                style="
                  background-color: #0d6efd;
                  color: white;
                  padding: 4px 8px;
                  border-radius: 4px;
                "
              >
                Personal Docs
              </h5>
            </div>
            <div id="document-container">
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Education Docs
                </h5>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Experienced Docs
                </h5>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="col-full mb-3">
                <h5
                  class="d-inline"
                  style="
                    background-color: #0d6efd;
                    color: white;
                    padding: 4px 8px;
                    border-radius: 4px;
                  "
                >
                  Training Docs
                </h5>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
              <div class="row document-row align-items-center mb-3">
                <div class="col-md-2">
                  {{ form.certificate.label_tag }}
                </div>
                <div class="col-md-4">
                  {{ form.certificate }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ======== TAB NAVIGATION BUTTONS ======== -->
        <div class="row mt-4">
          <div class="col-md-12 d-flex justify-content-between">
            <!-- Back button -->
            <a href="{% url 'employees:list' %}" class="btn btn-secondary">
              <i class="fas fa-arrow-left"></i> Back to List
            </a>

            <!-- NEXT Button -->
            <button type="button" class="btn btn-primary" id="nextBtn">
              Next <i class="fas fa-arrow-right"></i>
            </button>

            <!-- SAVE Button (hidden except on last tab) -->
            <button type="submit" class="btn btn-success d-none" id="saveBtn">
              <i class="fas fa-save"></i> Save Employee
            </button>
          </div>
        </div>
      </form>

      <!-- ========================== JAVASCRIPT ========================== -->
      <script>
        document.addEventListener('DOMContentLoaded', function() {
          // ========== TAB NAVIGATION LOGIC ==========
          const tabButtons = document.querySelectorAll('#employeeTab .nav-link');
          const nextBtn = document.getElementById('nextBtn');
          const saveBtn = document.getElementById('saveBtn');
          
          // Array of tab IDs in order
          const tabOrder = [
            'employee-tab',
            'basic-tab',
            'offical_info-tab',
            'job_experience-tab',
            'salary_info-tab',
            'education-tab',
            'leave-tab',
            'training-tab',
            'document-tab'
          ];
          
          // Function to get current active tab index
          function getCurrentTabIndex() {
            for (let i = 0; i < tabOrder.length; i++) {
              const tab = document.getElementById(tabOrder[i]);
              if (tab && tab.classList.contains('active')) {
                return i;
              }
            }
            return 0;
          }
          
          // Function to show/hide Next and Save buttons
          function updateButtons() {
            const currentIndex = getCurrentTabIndex();
            const isLastTab = currentIndex === tabOrder.length - 1;
            
            if (isLastTab) {
              nextBtn.classList.add('d-none');
              saveBtn.classList.remove('d-none');
            } else {
              nextBtn.classList.remove('d-none');
              saveBtn.classList.add('d-none');
            }
          }
          
          // Optional: Validate current tab before moving to next
          function validateCurrentTab() {
            const currentIndex = getCurrentTabIndex();
            const currentTabPaneId = tabOrder[currentIndex].replace('-tab', '');
            const currentPane = document.getElementById(currentTabPaneId);
            
            if (!currentPane) return true;
            
            // Get all required fields in current tab
            const requiredFields = currentPane.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
              if (!field.value.trim()) {
                field.classList.add('is-invalid');
                isValid = false;
              } else {
                field.classList.remove('is-invalid');
              }
            });
            
            return isValid;
          }
          
          // Next button click handler
          nextBtn.addEventListener('click', function() {
            // Optional: Uncomment below to enable validation
            // if (!validateCurrentTab()) {
            //   alert('Please fill in all required fields before proceeding.');
            //   return;
            // }
            
            const currentIndex = getCurrentTabIndex();
            
            // Check if there's a next tab
            if (currentIndex < tabOrder.length - 1) {
              const nextTabId = tabOrder[currentIndex + 1];
              const nextTabButton = document.getElementById(nextTabId);
              
              if (nextTabButton) {
                // Trigger Bootstrap tab show
                const tab = new bootstrap.Tab(nextTabButton);
                tab.show();
                
                // Scroll to top of form
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Update buttons
                updateButtons();
              }
            }
          });
          
          // Listen to tab change events to update buttons
          tabButtons.forEach(button => {
            button.addEventListener('shown.bs.tab', function() {
              updateButtons();
            });
          });
          
          // Initialize button state
          updateButtons();
          
          // ========== CASCADING DROPDOWN LOGIC ==========
          function setupCascading(parentId, childId, url) {
            const parent = document.getElementById(parentId);
            const child = document.getElementById(childId);

            if (parent && child) {
              parent.addEventListener('change', function() {
                const value = parent.value;
                fetch(`${url}?${parentId}=${value}`)
                  .then(response => response.json())
                  .then(data => {
                    child.innerHTML = '';
                    child.insertAdjacentHTML('beforeend', '<option value="">---------</option>');
                    data[childId].forEach(item => {
                      child.insertAdjacentHTML('beforeend', `<option value="${item.id}">${item.name}</option>`);
                    });
                  })
                  .catch(error => console.error('Error loading data:', error));
              });
            }
          }

          setupCascading('id_unit', 'id_division', '{% url "employees:ajax_load_divisions" %}');
          setupCascading('id_division', 'id_department', '{% url "employees:ajax_load_departments" %}');
          setupCascading('id_department', 'id_section', '{% url "employees:ajax_load_sections" %}');
          setupCascading('id_section', 'id_sub_section', '{% url "employees:ajax_load_sub_sections" %}');
          setupCascading('id_sub_section', 'id_floor', '{% url "employees:ajax_load_floors" %}');
          setupCascading('id_floor', 'id_line', '{% url "employees:ajax_load_lines" %}');
          
          // ========== COPY PRESENT TO PERMANENT ADDRESS ==========
          const sameAsPresent = document.getElementById('sameAsPresent');
          
          // Mapping of present address fields to permanent address fields
          const addressMapping = {
            'id_country': 'id_perm_country',
            'id_division': 'id_perm_division',
            'id_district': 'id_perm_district',
            'id_thana': 'id_perm_thana',
            'id_post_office': 'id_perm_post_office',
            'id_post_office_Bangla': 'id_perm_post_office_bangla',
            'id_postal_code': 'id_perm_postal_code',
            'id_village': 'id_perm_village',
            'id_address_line': 'id_perm_address_line',
            'id_address_line_Bangla': 'id_perm_address_line_bangla'
          };
          
          // Function to copy present address to permanent address
          function copyPresentToPermanent() {
            for (const [presentId, permanentId] of Object.entries(addressMapping)) {
              const presentField = document.getElementById(presentId);
              const permanentField = document.getElementById(permanentId);
              
              if (presentField && permanentField) {
                if (sameAsPresent.checked) {
                  // Copy value and disable permanent field
                  if (presentField.tagName === 'SELECT') {
                    permanentField.value = presentField.value;
                    // If permanent is also a select, trigger change event
                    permanentField.dispatchEvent(new Event('change'));
                  } else {
                    permanentField.value = presentField.value;
                  }
                  permanentField.readOnly = true;
                  permanentField.style.backgroundColor = '#e9ecef';
                } else {
                  // Enable permanent field for editing
                  permanentField.readOnly = false;
                  permanentField.style.backgroundColor = '';
                }
              }
            }
          }
          
          // Event listener for checkbox
          if (sameAsPresent) {
            sameAsPresent.addEventListener('change', copyPresentToPermanent);
            
            // Also listen to changes in present address fields when checkbox is checked
            Object.keys(addressMapping).forEach(presentId => {
              const presentField = document.getElementById(presentId);
              if (presentField) {
                presentField.addEventListener('input', function() {
                  if (sameAsPresent.checked) {
                    copyPresentToPermanent();
                  }
                });
                
                // For select fields, listen to change event
                if (presentField.tagName === 'SELECT') {
                  presentField.addEventListener('change', function() {
                    if (sameAsPresent.checked) {
                      copyPresentToPermanent();
                    }
                  });
                }
              }
            });
          }
        });
      </script>
    </div>
  </div>
</div>

<!-- ========================== STYLES ========================== -->
<style>
  .nav-pills .nav-link {
    border-radius: 30px;
    font-weight: 500;
  }
  .nav-pills .nav-link.active {
    background-color: #0d6efd;
  }
  .section-title h5 {
    border-bottom: 2px solid #dee2e6;
    padding-bottom: 6px;
    font-weight: 600;
  }
  .form-label {
    font-weight: 500;
  }
  .btn {
    min-width: 150px;
  }
  .is-invalid {
    border-color: #dc3545 !important;
  }
  .is-invalid:focus {
    box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
  }
</style>
{% endblock %}